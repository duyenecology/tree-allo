% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  12pt,
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother

\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage[default]{sourcesanspro}
\usepackage{sourcecodepro}
\usepackage{lineno}
\usepackage{setspace}
\renewcommand{\thetable}{S\arabic{table}}
\renewcommand{\thefigure}{S\arabic{figure}}
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\author{}
\date{}

\begin{document}


\emph{Supplement of}

\textbf{Nguyen and Katabuchi, Saturating allometric relationships reveal
how wood density shapes global tree architecture}

This supplement includes the following materials:

\section{Section S1. Extra figures and
tables}\label{section-s1.-extra-figures-and-tables}

\textbf{Table S1.} List of sources for wood density data used in this
study, as released in version 6 of the TRY database. The table includes
authors' names, dataset IDs, and the name of each dataset.

\textbf{Table S2.} Characteristics of the sub-datasets used to select
the best predictive model for each allometric relationship in
angiosperms and gymnosperms.

\textbf{Table S3.} Parameter estimates for all hierarchical models for
tree height allometry.

\textbf{Table S4.} Parameter estimates for all hierarchical models for
crown radius allometry.

\textbf{Table S5.} Parameter estimates for all hierarchical models for
DBH allometry.

\textbf{Table S6.} Parameter estimates for predicting tree height (m)
from DBH (cm) of 1290 species (see file
\emph{TableS6\_height\_sp\_estimates.xlsx}).

\textbf{Table S7.} Parameter estimates for predicting crown radius (m)
from DBH (cm) of 821 species (see file
\emph{TableS7\_crown\_radius\_sp\_estimates.xlsx}).

\textbf{Table S8.} Parameter estimates for predicting DBH (cm) from
crown radius (m) and tree height (m) of 800 species (see file
\emph{TableS8\_dbh\_sp\_estimates.xlsx}).

\textbf{Figure S1.} Functional curves describing allometric
relationships of tree dimensions with DBH on the log scale.

\section{Section S2. Stan code used to fit alternative allometric
models}\label{section-s2.-stan-code-used-to-fit-alternative-allometric-models}

\newpage

\section{Section S1. Extra tables and
figures}\label{section-s1.-extra-tables-and-figures}

\textbf{Table S1}: List of sources for wood density data utilized in
this study, as released in version 6 of the TRY database. The table
includes authors' names, dataset IDs, and the name of each dataset.

\begingroup\fontsize{10}{12}\selectfont

\begin{longtable*}[t]{ccccc}
\toprule
No. & LastName & FirstName & DatasetID & Dataset\\
\midrule
1 & Cornelissen & Johannes & 37 & Sheffield Database\\
2 & Swaine & Emily & 51 & Tropical Plant Traits From Borneo Database\\
3 & Kleyer & Michael & 25 & The LEDA Traitbase\\
4 & Cornwell & Will & 55 & Jasper Ridge Californian Woody Plants Database\\
5 & Lloyd & Jon & 34 & The RAINFOR Plant Trait Database\\
\bottomrule
\end{longtable*}
\endgroup{}

\newpage

\textbf{Table S2}: Characteristics of the sub-datasets used to select
the best predictive model for each allometric relationship in
angiosperms and gymnosperms. The ranges represent the minimum and
maximum values for the respective variables: DBH (cm), tree height (H,
m), crown radius (CR, m), and wood density (WD, g
cm\textsuperscript{-3}).

\begingroup\fontsize{10}{12}\selectfont

\begin{longtable*}[t]{ccccc}
\toprule
Dependent variables & Predictor variable & Characteristics & Angiosperm & Gymnosperm\\
\midrule
H & DBH & Number of trees & 79,332 & 6,306\\
H & DBH & Number of species & 1,214 & 76\\
H & DBH & Dependent variable range & 1.3 - 94 & 1.3 - 115.8\\
H & DBH & Predictor variable range & 1 - 560 & 1 - 648\\
H & DBH & WD range & 0.131 - 1.17 & 0.32 - 0.689\\
\addlinespace
CR & DBH & Number of trees & 45,350 & 4,632\\
CR & DBH & Number of species & 762 & 59\\
CR & DBH & Dependent variable range & 0.05 - 24.25 & 0.1 - 8.75\\
CR & DBH & Predictor variable range & 1 - 385 & 1 - 266\\
CR & DBH & WD range & 0.131 - 1.15 & 0.32 - 0.689\\
\addlinespace
DBH & CR, H & Number of trees & 41,713 & 3,661\\
DBH & CR, H & Number of species & 744 & 56\\
DBH & CR, H & Dependent variable range & 1 - 385 & 1 - 266\\
DBH & CR, H & Predictor variable range & CR: 0.1 - 24.25 H: 1.3 - 70.6 & CR: 0.1 - 10.65 H: 1.3 - 46.2\\
DBH & CR, H & WD range & 0.131 - 1.15 & 0.32 - 0.651\\
\addlinespace
DBH & CR × H & Number of trees & 41,733 & 3,716\\
DBH & CR × H & Number of species & 743 & 56\\
DBH & CR × H & Dependent variable range & 1 - 385 & 1 - 266\\
DBH & CR × H & Predictor variable range & CR: 0.1 - 24.25 H: 1.3 - 70.6 & CR: 0.15 - 10.65 H: 1.5 - 53.9\\
DBH & CR × H & WD range & 0.131 - 1.15 & 0.32 - 0.651\\
\addlinespace
DBH & CR & Number of trees & 41,733 & 3,702\\
DBH & CR & Number of species & 744 & 56\\
DBH & CR & Dependent variable range & 1 - 385 & 1 - 266\\
DBH & CR & Predictor variable range & 0.1 - 24.25 & 0.15 - 8.75\\
DBH & CR & WD range & 0.131 - 1.15 & 0.32 - 0.651\\
\addlinespace
DBH & H & Number of trees & 41,689 & 3,648\\
DBH & H & Number of species & 746 & 55\\
DBH & H & Dependent variable range & 1 - 385 & 1 - 266\\
DBH & H & Predictor variable range & 1.3 - 70.6 & 1.5 - 46.2\\
DBH & H & WD range & 0.131 - 1.15 & 0.32 - 0.651\\
\bottomrule
\end{longtable*}
\endgroup{}

\newpage

\textbf{Table S3}: Posterior estimates of the parameters of the
hierarchical models for tree height allometry. Table entries correspond
to the median and 95\% CIs for the community-level parameters of each
allometric function.

\begingroup\fontsize{10}{12}\selectfont

\begin{longtable*}[t]{ccccccc}
\toprule
Division & Functional\_form & Wood\_density & Parameter & Intercept\_CI & Slope\_CI & Tau\_CI\\
\midrule
Angiosperm & Power-Law & Without & a & 2.55 (2.50, 2.60) & - & 0.311 (0.296, 0.326)\\
Angiosperm & Power-Law & Without & b & 0.538 (0.530, 0.544) & - & 0.108 (0.103, 0.114)\\
Angiosperm & gMM & Without & a & 77.9 (73.8, 82.5) & - & 0.140 (0.115, 0.164)\\
Angiosperm & gMM & Without & b & 0.640 (0.629, 0.651) & - & 0.148 (0.140, 0.156)\\
Angiosperm & gMM & Without & k & 35.0 (33.2, 36.9) & - & 8.95 (8.23, 9.66)\\
\addlinespace
Angiosperm & Weibull & Without & a & 50.0 (48.0, 52.2) & - & 0.109 (0.0847, 0.133)\\
Angiosperm & Weibull & Without & b & 0.0476 (0.0458, 0.0495) & - & 0.0118 (0.0110, 0.0126)\\
Angiosperm & Weibull & Without & k & 0.629 (0.618, 0.639) & - & 0.142 (0.135, 0.149)\\
Angiosperm & Weibull & With & a & 50.0 (48.0, 52.3) & 1.00 (0.966, 1.04) & 0.109 (0.0850, 0.134)\\
Angiosperm & Weibull & With & b & 0.0477 (0.0456, 0.0495) & -0.000250 (-0.00189, 0.00142) & 0.0118 (0.0109, 0.0126)\\
\addlinespace
Angiosperm & Weibull & With & k & 0.628 (0.618, 0.638) & -0.0155 (-0.0254, -0.00591) & 0.141 (0.134, 0.149)\\
Gymnosperm & Power-Law & Without & a & 1.43 (1.30, 1.56) & - & 0.371 (0.303, 0.447)\\
Gymnosperm & Power-Law & Without & b & 0.704 (0.675, 0.732) & - & 0.113 (0.0927, 0.137)\\
Gymnosperm & gMM & Without & a & 2005 (386, 7618) & - & 0.360 (0.298, 0.434)\\
Gymnosperm & gMM & Without & b & 0.716 (0.687, 0.746) & - & 0.112 (0.0908, 0.138)\\
\addlinespace
Gymnosperm & gMM & Without & k & 1427 (287, 5308) & - & 5.90 (0.0814, 32.2)\\
Gymnosperm & Weibull & Without & a & 117 (89.2, 175) & - & 0.0912 (0.00357, 0.229)\\
Gymnosperm & Weibull & Without & b & 0.0119 (0.00806, 0.0155) & - & 0.00371 (0.00230, 0.00525)\\
Gymnosperm & Weibull & Without & k & 0.750 (0.719, 0.784) & - & 0.114 (0.0919, 0.139)\\
Gymnosperm & Weibull & With & a & 114 (85.1, 170) & 0.974 (0.776, 1.21) & 0.0976 (0.00466, 0.257)\\
\addlinespace
Gymnosperm & Weibull & With & b & 0.0123 (0.00836, 0.0163) & 0.000633 (-0.00188, 0.00342) & 0.00382 (0.00225, 0.00553)\\
Gymnosperm & Weibull & With & k & 0.751 (0.721, 0.784) & -0.0224 (-0.0538, 0.00762) & 0.113 (0.0905, 0.140)\\
\bottomrule
\end{longtable*}
\endgroup{}

\newpage

\textbf{Table S4}: Posterior estimates of the parameters of the
hierarchical models for crown radius allometry. Table entries correspond
to the median and 95\% CIs for the community-level parameters of each
allometric function.

\begingroup\fontsize{10}{12}\selectfont

\begin{longtable*}[t]{ccccccc}
\toprule
Division & Functional\_form & Wood\_density & Parameter & Intercept\_CI & Slope\_CI & Tau\_CI\\
\midrule
Angiosperm & Power-Law & Without & a & 0.349 (0.340, 0.359) & - & 0.336 (0.316, 0.358)\\
Angiosperm & Power-Law & Without & b & 0.626 (0.617, 0.635) & - & 0.0929 (0.0852, 0.101)\\
Angiosperm & Power-Law & With & a & 0.349 (0.340, 0.359) & 0.0680 (0.0395, 0.0970) & 0.331 (0.311, 0.354)\\
Angiosperm & Power-Law & With & b & 0.626 (0.617, 0.635) & -0.0110 (-0.0199, -0.00253) & 0.0921 (0.0844, 0.100)\\
Angiosperm & gMM & Without & a & 1382 (625, 2564) & - & 0.336 (0.315, 0.357)\\
\addlinespace
Angiosperm & gMM & Without & b & 0.627 (0.618, 0.636) & - & 0.0932 (0.0858, 0.101)\\
Angiosperm & gMM & Without & k & 3975 (1807, 7386) & - & 7.24 (0.0919, 50.7)\\
Angiosperm & Weibull & Without & a & 458 (175, 1761) & - & 0.311 (0.255, 0.348)\\
Angiosperm & Weibull & Without & b & 0.000765 (0.000200, 0.00200) & - & 9.6665278454e-05 (5.092834e-06, 0.00031932395)\\
Angiosperm & Weibull & Without & k & 0.627 (0.619, 0.637) & - & 0.0934 (0.0859, 0.101)\\
\addlinespace
Gymnosperm & Power-Law & Without & a & 0.298 (0.270, 0.329) & - & 0.324 (0.251, 0.415)\\
Gymnosperm & Power-Law & Without & b & 0.619 (0.591, 0.647) & - & 0.0861 (0.0627, 0.114)\\
Gymnosperm & gMM & Without & a & 769 (227, 1818) & - & 0.367 (0.280, 0.465)\\
Gymnosperm & gMM & Without & b & 0.631 (0.600, 0.663) & - & 0.101 (0.0755, 0.131)\\
Gymnosperm & gMM & Without & k & 2657 (809, 6274) & - & 19.0 (0.112, 200)\\
\addlinespace
Gymnosperm & gMM & With & a & 975 (312, 2010) & 0.988 (0.766, 1.27) & 0.367 (0.280, 0.474)\\
Gymnosperm & gMM & With & b & 0.629 (0.599, 0.659) & 0.0345 (0.00507, 0.0642) & 0.0949 (0.0691, 0.126)\\
Gymnosperm & gMM & With & k & 3371 (1094, 6978) & 35.7 (-769, 914) & 9.36 (0.100, 52.3)\\
Gymnosperm & Weibull & Without & a & 61.0 (21.5, 322) & - & 0.202 (0.0145, 0.411)\\
Gymnosperm & Weibull & Without & b & 0.00487 (0.000906, 0.0139) & - & 0.00156209428218 (5.166957e-05, 0.00459459775)\\
\addlinespace
Gymnosperm & Weibull & Without & k & 0.640 (0.606, 0.674) & - & 0.102 (0.0775, 0.133)\\
\bottomrule
\end{longtable*}
\endgroup{}

\newpage

\textbf{Table S5}: Posterior estimates of the parameters of the
hierarchical models for DBH allometry. Table entries correspond to the
median and 95\% CIs for the community-level parameters of each
allometric function.

\begingroup\fontsize{10}{12}\selectfont

\begin{longtable*}[t]{cccccccc}
\toprule
Division & Predictor & Functional\_form & Wood\_density & Parameter & Intercept\_CI & Slope\_CI & Tau\_CI\\
\midrule
Angiosperm & CR, H & Power-Law & Without & a & 0.948 (0.927, 0.969) & - & 0.302 (0.284, 0.320)\\
Angiosperm & CR, H & Power-Law & Without & b & 0.374 (0.361, 0.386) & - & 0.135 (0.125, 0.145)\\
Angiosperm & CR, H & Power-Law & Without & c & 0.590 (0.575, 0.605) & - & 0.168 (0.157, 0.180)\\
Angiosperm & CR, H & Power-Law & With & a & 0.949 (0.928, 0.970) & -0.00254 (-0.0265, 0.0190) & 0.301 (0.284, 0.320)\\
Angiosperm & CR, H & Power-Law & With & b & 0.373 (0.361, 0.386) & -0.00327 (-0.0146, 0.00891) & 0.135 (0.125, 0.145)\\
\addlinespace
Angiosperm & CR, H & Power-Law & With & c & 0.589 (0.575, 0.605) & 0.00511 (-0.00957, 0.0200) & 0.168 (0.156, 0.179)\\
Angiosperm & CR × H & Power-Law & Without & a & 0.955 (0.934, 0.978) & - & 0.307 (0.291, 0.325)\\
Angiosperm & CR × H & Power-Law & Without & b & 0.873 (0.859, 0.886) & - & 0.167 (0.156, 0.178)\\
Angiosperm & CR & Power-Law & Without & a & 0.950 (0.917, 0.983) & - & 0.424 (0.403, 0.447)\\
Angiosperm & CR & Power-Law & Without & b & 0.717 (0.699, 0.735) & - & 0.236 (0.223, 0.251)\\
\addlinespace
Angiosperm & H & Power-Law & Without & a & 0.967 (0.941, 0.993) & - & 0.353 (0.334, 0.373)\\
Angiosperm & H & Power-Law & Without & b & 0.866 (0.849, 0.881) & - & 0.200 (0.188, 0.214)\\
Gymnosperm & CR, H & Power-Law & Without & a & 0.972 (0.903, 1.05) & - & 0.273 (0.222, 0.336)\\
Gymnosperm & CR, H & Power-Law & Without & b & 0.410 (0.373, 0.446) & - & 0.115 (0.0861, 0.150)\\
Gymnosperm & CR, H & Power-Law & Without & c & 0.588 (0.540, 0.638) & - & 0.165 (0.129, 0.209)\\
\addlinespace
Gymnosperm & CR, H & Power-Law & With & a & 0.971 (0.900, 1.04) & -0.0451 (-0.120, 0.0295) & 0.274 (0.225, 0.339)\\
Gymnosperm & CR, H & Power-Law & With & b & 0.408 (0.371, 0.444) & 0.0284 (-0.00773, 0.0616) & 0.112 (0.0845, 0.148)\\
Gymnosperm & CR, H & Power-Law & With & c & 0.588 (0.538, 0.637) & -0.0364 (-0.0841, 0.0140) & 0.165 (0.128, 0.209)\\
Gymnosperm & CR × H & Power-Law & Without & a & 0.990 (0.920, 1.07) & - & 0.282 (0.231, 0.347)\\
Gymnosperm & CR × H & Power-Law & Without & b & 0.895 (0.843, 0.942) & - & 0.182 (0.147, 0.225)\\
\addlinespace
Gymnosperm & CR & Power-Law & Without & a & 0.971 (0.887, 1.06) & - & 0.344 (0.280, 0.419)\\
Gymnosperm & CR & Power-Law & Without & b & 0.791 (0.712, 0.870) & - & 0.274 (0.221, 0.336)\\
Gymnosperm & H & Power-Law & Without & a & 0.998 (0.901, 1.09) & - & 0.348 (0.287, 0.427)\\
Gymnosperm & H & Power-Law & Without & b & 0.849 (0.787, 0.915) & - & 0.224 (0.179, 0.279)\\
\bottomrule
\end{longtable*}
\endgroup{}

\newpage

\begin{figure}[H]

\centering{

\pandocbounded{\includegraphics[keepaspectratio]{../figs/h_cr_dbh_log.png}}

}

\caption{\label{fig-compare}Allometric relationships between DBH and
tree height or crown radius in angiosperms (a, c) and gymnosperms (b,
d), based on three different models: power-law (orange), generalized
Michaelis-Menten (green), and Weibull (blue). A color gradient from
black (low density) to yellow (high density) indicates the density of
overlapping data points, calculated via 2D kernel density estimation on
a 300\,\(\times\)\,300 grid. All axes are shown on the log scale.}

\end{figure}%

\newpage

\section{Section S2. Stan code used to fit alternative allometric
models}\label{section-s2.-stan-code-used-to-fit-alternative-allometric-models-1}

\subsection{Power-law model}\label{power-law-model}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each trees}
  \DataTypeTok{matrix}\NormalTok{[N, K] log\_x;                }\CommentTok{// tree{-}level predictors}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[K] gamma;}
  \DataTypeTok{matrix}\NormalTok{[K, J] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[K, J] beta;}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[k, ] = gamma[k] + tau[k] * z[k, ];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  sigma \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{);}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  tau \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  gamma \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_mu[n] = log\_x[n, ] * beta[, jj[n]];}
\NormalTok{  \}}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] | log\_x[n, ] * beta[, jj[n]], sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\newpage

\subsection{Power-law model with wood
density}\label{power-law-model-with-wood-density}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} L;                    }\CommentTok{// num sp{-}level predictor}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each trees}
  \DataTypeTok{matrix}\NormalTok{[N, K] log\_x;                }\CommentTok{// tree{-}level predictors}
  \DataTypeTok{matrix}\NormalTok{[L, J] u;                    }\CommentTok{// sp{-}level predictors}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[K, L] gamma;}
  \DataTypeTok{matrix}\NormalTok{[K, J] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[K, J] beta;}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[k, ] = gamma[k, ] * u + tau[k] * z[k, ];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  to\_vector(gamma) \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  tau \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_mu[n] = log\_x[n, ] * beta[, jj[n]];}
\NormalTok{  \}}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] | log\_x[n, ] * beta[, jj[n]], sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\newpage

\subsection{Generalized Michaelis-Menten
model}\label{generalized-michaelis-menten-model}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each tree}
  \DataTypeTok{vector}\NormalTok{[N] x;                       }\CommentTok{// DBH (non{-}log{-}scale)}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] gamma\_hat;}
  \DataTypeTok{matrix}\NormalTok{[J, K] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[J, K] beta;}
  \DataTypeTok{vector}\NormalTok{[K] gamma;}
\NormalTok{  gamma[}\DecValTok{1}\NormalTok{] = gamma\_hat[}\DecValTok{1}\NormalTok{] * }\DecValTok{10}\NormalTok{;}
\NormalTok{  gamma[}\DecValTok{2}\NormalTok{] = gamma\_hat[}\DecValTok{2}\NormalTok{];}
\NormalTok{  gamma[}\DecValTok{3}\NormalTok{] = gamma\_hat[}\DecValTok{3}\NormalTok{] * }\DecValTok{1000}\NormalTok{;}
  \CommentTok{// Corrected matrix multiplication and addition}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[, k] =  gamma[k] + tau[k] * z[, k];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  sigma \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{);}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  tau \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  gamma\_hat \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  log\_mu = beta[jj, }\DecValTok{1}\NormalTok{] + beta[jj, }\DecValTok{2}\NormalTok{] .* log(x) {-}}
\NormalTok{      log(beta[jj, }\DecValTok{3}\NormalTok{] + pow(x, beta[jj, }\DecValTok{2}\NormalTok{]));}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] |}
\NormalTok{      beta[jj[n], }\DecValTok{1}\NormalTok{] +}
\NormalTok{      beta[jj[n], }\DecValTok{2}\NormalTok{] * log(x[n]) {-}}
\NormalTok{      log(beta[jj[n], }\DecValTok{3}\NormalTok{] + pow(x[n], beta[jj[n], }\DecValTok{2}\NormalTok{])),}
\NormalTok{      sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\newpage

\subsection{Generalized Michaelis-Menten model with wood
density}\label{generalized-michaelis-menten-model-with-wood-density}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} L;                    }\CommentTok{// num sp{-}level predictor}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each tree}
  \DataTypeTok{vector}\NormalTok{[N] x;                       }\CommentTok{// DBH (non{-}log{-}scale)}
  \DataTypeTok{matrix}\NormalTok{[J, L] u;                    }\CommentTok{// sp{-}level predictors}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] gamma\_int\_hat;}
  \DataTypeTok{vector}\NormalTok{[K] gamma\_slope\_hat;}
  \DataTypeTok{matrix}\NormalTok{[J, K] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[J, K] beta;}
  \DataTypeTok{row\_vector}\NormalTok{[K] gamma\_int;}
  \DataTypeTok{row\_vector}\NormalTok{[K] gamma\_slope;}
\NormalTok{  gamma\_int[}\DecValTok{1}\NormalTok{] = gamma\_int\_hat[}\DecValTok{1}\NormalTok{] * }\DecValTok{10}\NormalTok{;}
\NormalTok{  gamma\_int[}\DecValTok{2}\NormalTok{] = gamma\_int\_hat[}\DecValTok{2}\NormalTok{];}
\NormalTok{  gamma\_int[}\DecValTok{3}\NormalTok{] = gamma\_int\_hat[}\DecValTok{3}\NormalTok{] * }\DecValTok{1000}\NormalTok{;}
\NormalTok{  gamma\_slope[}\DecValTok{1}\NormalTok{] = gamma\_slope\_hat[}\DecValTok{1}\NormalTok{] * }\DecValTok{10}\NormalTok{;}
\NormalTok{  gamma\_slope[}\DecValTok{2}\NormalTok{] = gamma\_slope\_hat[}\DecValTok{2}\NormalTok{];}
\NormalTok{  gamma\_slope[}\DecValTok{3}\NormalTok{] = gamma\_slope\_hat[}\DecValTok{3}\NormalTok{] * }\DecValTok{1000}\NormalTok{;}
  \DataTypeTok{matrix}\NormalTok{[}\DecValTok{2}\NormalTok{, K] gamma = append\_row(gamma\_int, gamma\_slope);}

  \CommentTok{// Corrected matrix multiplication and addition}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[, k] = u * gamma[, k] + tau[k] * z[, k];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  tau \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  gamma\_int\_hat \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  gamma\_slope\_hat \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{1.25}\NormalTok{);}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_mu[n] = beta[jj[n], }\DecValTok{1}\NormalTok{] + beta[jj[n], }\DecValTok{2}\NormalTok{] * log(x[n]) {-}}
\NormalTok{      log(beta[jj[n], }\DecValTok{3}\NormalTok{] + pow(x[n], beta[jj[n], }\DecValTok{2}\NormalTok{]));}
\NormalTok{  \}}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] |}
\NormalTok{      beta[jj[n], }\DecValTok{1}\NormalTok{] +}
\NormalTok{      beta[jj[n], }\DecValTok{2}\NormalTok{] * log(x[n]) {-}}
\NormalTok{      log(beta[jj[n], }\DecValTok{3}\NormalTok{] + pow(x[n], beta[jj[n], }\DecValTok{2}\NormalTok{])),}
\NormalTok{      sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\newpage

\subsection{Weibull model}\label{weibull-model}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each tree}
  \DataTypeTok{vector}\NormalTok{[N] x;                       }\CommentTok{// DBH (non{-}log{-}scale)}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] gamma;}
  \DataTypeTok{matrix}\NormalTok{[J, K] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[J, K] beta;}
  \CommentTok{// Corrected matrix multiplication and addition}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[, k] =  gamma[k] + tau[k] * z[, k];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  sigma \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{);}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  tau \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  gamma \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  log\_mu = beta[jj, }\DecValTok{1}\NormalTok{] + log1m\_exp({-}beta[jj, }\DecValTok{2}\NormalTok{] .* pow(x, beta[jj, }\DecValTok{3}\NormalTok{]));}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] |}
\NormalTok{      beta[jj[n], }\DecValTok{1}\NormalTok{] + log1m\_exp({-}beta[jj[n], }\DecValTok{2}\NormalTok{] * pow(x[n], beta[jj[n], }\DecValTok{3}\NormalTok{])),}
\NormalTok{      sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\newpage

\subsection{Weibull model with wood
density}\label{weibull-model-with-wood-density}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} L;                    }\CommentTok{// num sp{-}level predictor}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each tree}
  \DataTypeTok{vector}\NormalTok{[N] x;                       }\CommentTok{// DBH (non{-}log{-}scale)}
  \DataTypeTok{matrix}\NormalTok{[J, L] u;                    }\CommentTok{// sp{-}level predictors}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{row\_vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] gamma\_int;}
  \DataTypeTok{row\_vector}\NormalTok{[K] gamma\_slope;}
  \DataTypeTok{matrix}\NormalTok{[J, K] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[J, K] beta;}
  \DataTypeTok{matrix}\NormalTok{[}\DecValTok{2}\NormalTok{, K] gamma = append\_row(gamma\_int, gamma\_slope);}

  \CommentTok{// Corrected matrix multiplication and addition}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[, k] = u * gamma[, k] + tau[k] * z[, k];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  to\_vector(gamma\_int) \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  to\_vector(gamma\_slope) \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{1.25}\NormalTok{);}
\NormalTok{  to\_vector(tau) \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_mu[n] = beta[jj[n], }\DecValTok{1}\NormalTok{] + log1m\_exp({-}beta[jj[n], }\DecValTok{2}\NormalTok{] * pow(x[n], beta[jj[n], }\DecValTok{3}\NormalTok{]));}
\NormalTok{  \}}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] |}
\NormalTok{      beta[jj[n], }\DecValTok{1}\NormalTok{] + log1m\_exp({-}beta[jj[n], }\DecValTok{2}\NormalTok{] * pow(x[n], beta[jj[n], }\DecValTok{3}\NormalTok{])),}
\NormalTok{      sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}





\end{document}
