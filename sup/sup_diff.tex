% Options for packages loaded elsewhere
%DIF LATEXDIFF DIFFERENCE FILE
%DIF DEL sup_old.tex   Tue Mar 25 06:02:48 2025
%DIF ADD sup.tex       Tue Mar 25 06:02:02 2025
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  12pt,
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother

\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage[default]{sourcesanspro}
\usepackage{sourcecodepro}
\usepackage{lineno}
%DIF 156c156-158
%DIF < \linenumbers
%DIF -------
\usepackage{setspace} %DIF > 
\renewcommand{\thetable}{S\arabic{table}} %DIF > 
\renewcommand{\thefigure}{S\arabic{figure}} %DIF > 
%DIF -------
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
%DIF 177-179c179
%DIF <   \renewcommand*\figurename{Figure
%DIF < 
%DIF < S}
%DIF -------
  \renewcommand*\figurename{Figure} %DIF > 
%DIF -------
\else
%DIF 181-183c181
%DIF <   \newcommand\figurename{Figure
%DIF < 
%DIF < S}
%DIF -------
  \newcommand\figurename{Figure} %DIF > 
%DIF -------
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\author{}
\date{}
%DIF PREAMBLE EXTENSION ADDED BY LATEXDIFF
%DIF UNDERLINE PREAMBLE %DIF PREAMBLE
\RequirePackage[normalem]{ulem} %DIF PREAMBLE
\RequirePackage{color}\definecolor{RED}{rgb}{1,0,0}\definecolor{BLUE}{rgb}{0,0,1} %DIF PREAMBLE
\providecommand{\DIFadd}[1]{{\protect\color{blue}\uwave{#1}}} %DIF PREAMBLE
\providecommand{\DIFdel}[1]{{\protect\color{red}\sout{#1}}}                      %DIF PREAMBLE
%DIF SAFE PREAMBLE %DIF PREAMBLE
\providecommand{\DIFaddbegin}{} %DIF PREAMBLE
\providecommand{\DIFaddend}{} %DIF PREAMBLE
\providecommand{\DIFdelbegin}{} %DIF PREAMBLE
\providecommand{\DIFdelend}{} %DIF PREAMBLE
\providecommand{\DIFmodbegin}{} %DIF PREAMBLE
\providecommand{\DIFmodend}{} %DIF PREAMBLE
%DIF FLOATSAFE PREAMBLE %DIF PREAMBLE
\providecommand{\DIFaddFL}[1]{\DIFadd{#1}} %DIF PREAMBLE
\providecommand{\DIFdelFL}[1]{\DIFdel{#1}} %DIF PREAMBLE
\providecommand{\DIFaddbeginFL}{} %DIF PREAMBLE
\providecommand{\DIFaddendFL}{} %DIF PREAMBLE
\providecommand{\DIFdelbeginFL}{} %DIF PREAMBLE
\providecommand{\DIFdelendFL}{} %DIF PREAMBLE
\newcommand{\DIFscaledelfig}{0.5}
%DIF HIGHLIGHTGRAPHICS PREAMBLE %DIF PREAMBLE
\RequirePackage{settobox} %DIF PREAMBLE
\RequirePackage{letltxmacro} %DIF PREAMBLE
\newsavebox{\DIFdelgraphicsbox} %DIF PREAMBLE
\newlength{\DIFdelgraphicswidth} %DIF PREAMBLE
\newlength{\DIFdelgraphicsheight} %DIF PREAMBLE
% store original definition of \includegraphics %DIF PREAMBLE
\LetLtxMacro{\DIFOincludegraphics}{\includegraphics} %DIF PREAMBLE
\newcommand{\DIFaddincludegraphics}[2][]{{\color{blue}\fbox{\DIFOincludegraphics[#1]{#2}}}} %DIF PREAMBLE
\newcommand{\DIFdelincludegraphics}[2][]{% %DIF PREAMBLE
\sbox{\DIFdelgraphicsbox}{\DIFOincludegraphics[#1]{#2}}% %DIF PREAMBLE
\settoboxwidth{\DIFdelgraphicswidth}{\DIFdelgraphicsbox} %DIF PREAMBLE
\settoboxtotalheight{\DIFdelgraphicsheight}{\DIFdelgraphicsbox} %DIF PREAMBLE
\scalebox{\DIFscaledelfig}{% %DIF PREAMBLE
\parbox[b]{\DIFdelgraphicswidth}{\usebox{\DIFdelgraphicsbox}\\[-\baselineskip] \rule{\DIFdelgraphicswidth}{0em}}\llap{\resizebox{\DIFdelgraphicswidth}{\DIFdelgraphicsheight}{% %DIF PREAMBLE
\setlength{\unitlength}{\DIFdelgraphicswidth}% %DIF PREAMBLE
\begin{picture}(1,1)% %DIF PREAMBLE
\thicklines\linethickness{2pt} %DIF PREAMBLE
{\color[rgb]{1,0,0}\put(0,0){\framebox(1,1){}}}% %DIF PREAMBLE
{\color[rgb]{1,0,0}\put(0,0){\line( 1,1){1}}}% %DIF PREAMBLE
{\color[rgb]{1,0,0}\put(0,1){\line(1,-1){1}}}% %DIF PREAMBLE
\end{picture}% %DIF PREAMBLE
}\hspace*{3pt}}} %DIF PREAMBLE
} %DIF PREAMBLE
\LetLtxMacro{\DIFOaddbegin}{\DIFaddbegin} %DIF PREAMBLE
\LetLtxMacro{\DIFOaddend}{\DIFaddend} %DIF PREAMBLE
\LetLtxMacro{\DIFOdelbegin}{\DIFdelbegin} %DIF PREAMBLE
\LetLtxMacro{\DIFOdelend}{\DIFdelend} %DIF PREAMBLE
\DeclareRobustCommand{\DIFaddbegin}{\DIFOaddbegin \let\includegraphics\DIFaddincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFaddend}{\DIFOaddend \let\includegraphics\DIFOincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFdelbegin}{\DIFOdelbegin \let\includegraphics\DIFdelincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFdelend}{\DIFOaddend \let\includegraphics\DIFOincludegraphics} %DIF PREAMBLE
\LetLtxMacro{\DIFOaddbeginFL}{\DIFaddbeginFL} %DIF PREAMBLE
\LetLtxMacro{\DIFOaddendFL}{\DIFaddendFL} %DIF PREAMBLE
\LetLtxMacro{\DIFOdelbeginFL}{\DIFdelbeginFL} %DIF PREAMBLE
\LetLtxMacro{\DIFOdelendFL}{\DIFdelendFL} %DIF PREAMBLE
\DeclareRobustCommand{\DIFaddbeginFL}{\DIFOaddbeginFL \let\includegraphics\DIFaddincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFaddendFL}{\DIFOaddendFL \let\includegraphics\DIFOincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFdelbeginFL}{\DIFOdelbeginFL \let\includegraphics\DIFdelincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFdelendFL}{\DIFOaddendFL \let\includegraphics\DIFOincludegraphics} %DIF PREAMBLE
%DIF LISTINGS PREAMBLE %DIF PREAMBLE
\RequirePackage{listings} %DIF PREAMBLE
\RequirePackage{color} %DIF PREAMBLE
\lstdefinelanguage{DIFcode}{ %DIF PREAMBLE
%DIF DIFCODE_UNDERLINE %DIF PREAMBLE
  moredelim=[il][\color{red}\sout]{\%DIF\ <\ }, %DIF PREAMBLE
  moredelim=[il][\color{blue}\uwave]{\%DIF\ >\ } %DIF PREAMBLE
} %DIF PREAMBLE
\lstdefinestyle{DIFverbatimstyle}{ %DIF PREAMBLE
	language=DIFcode, %DIF PREAMBLE
	basicstyle=\ttfamily, %DIF PREAMBLE
	columns=fullflexible, %DIF PREAMBLE
	keepspaces=true %DIF PREAMBLE
} %DIF PREAMBLE
\lstnewenvironment{DIFverbatim}{\lstset{style=DIFverbatimstyle}}{} %DIF PREAMBLE
\lstnewenvironment{DIFverbatim*}{\lstset{style=DIFverbatimstyle,showspaces=true}}{} %DIF PREAMBLE
%DIF END PREAMBLE EXTENSION ADDED BY LATEXDIFF

\begin{document}


\emph{Supplement of}

\textbf{\DIFaddbegin \DIFadd{Nguyen and Katabuchi, }\DIFaddend Saturating allometric relationships reveal
how wood \DIFdelbegin \DIFdel{densityshapes }\DIFdelend \DIFaddbegin \DIFadd{density shapes }\DIFaddend global tree architecture}

\DIFdelbegin %DIFDELCMD < \newpage
%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend This supplement includes the following materials:

\section{Section S1. Extra figures and
tables}\label{section-s1.-extra-figures-and-tables}

\textbf{Table S1.} List of sources for wood density data used in this
study, as released in version 6 of the TRY database. The table includes
authors' names, dataset IDs, and the name of each dataset.

\textbf{Table S2.} Characteristics of \DIFaddbegin \DIFadd{the }\DIFaddend sub-datasets \DIFdelbegin \DIFdel{were }\DIFdelend used to select
the best predictive model \DIFdelbegin \DIFdel{of }\DIFdelend \DIFaddbegin \DIFadd{for }\DIFaddend each allometric relationship \DIFdelbegin \DIFdel{for
}\DIFdelend \DIFaddbegin \DIFadd{in
}\DIFaddend angiosperms and gymnosperms.

\textbf{Table S3.} Parameter estimates for all hierarchical models for
tree height allometry.

\textbf{Table S4.} Parameter estimates for all hierarchical models for
crown radius allometry.

\textbf{Table S5.} Parameter estimates for all hierarchical models for
DBH allometry.

\textbf{Table S6.} Parameter estimates for predicting tree height (m)
from DBH (cm) of 1290 species (see file
\DIFdelbegin \DIFdel{TableS6\_height\_sp\_estimates.csv}\DIFdelend \DIFaddbegin \emph{\DIFadd{TableS6\_height\_sp\_estimates.xlsx}}\DIFaddend ).

\textbf{Table S7.} Parameter estimates for predicting crown radius (m)
from DBH (cm) of 821 species (see file
\DIFdelbegin \DIFdel{TableS7\_crown\_radius\_sp\_estimates.csv}\DIFdelend \DIFaddbegin \emph{\DIFadd{TableS7\_crown\_radius\_sp\_estimates.xlsx}}\DIFaddend ).

\textbf{Table S8.} Parameter estimates for predicting DBH (cm) from
crown radius (m) and tree height (m) of 800 species (see file
\DIFdelbegin \DIFdel{TableS8\_dbh\_sp\_estimates.csv}\DIFdelend \DIFaddbegin \emph{\DIFadd{TableS8\_dbh\_sp\_estimates.xlsx}}\DIFaddend ).

\textbf{Figure S1.} \DIFdelbegin \DIFdel{Function curves are used to describe }\DIFdelend \DIFaddbegin \DIFadd{Functional curves describing }\DIFaddend allometric
relationships of tree dimensions with DBH \DIFdelbegin \DIFdel{in }\DIFdelend \DIFaddbegin \DIFadd{on the }\DIFaddend log scale.

\section{Section S2. Stan code used to fit alternative allometric
models}\label{section-s2.-stan-code-used-to-fit-alternative-allometric-models}

\newpage

\section{Section S1. Extra tables and
figures}\label{section-s1.-extra-tables-and-figures}

\textbf{Table S1}: List of sources for wood density data utilized in
this study, as released in version 6 of the TRY database. The table
includes authors' names, dataset IDs, and the name of each dataset.

\begingroup\fontsize{10}{12}\selectfont

\begin{longtable*}[t]{ccccc}
\toprule
No. & LastName & FirstName & DatasetID & Dataset\\
\midrule
1 & Cornelissen & Johannes & 37 & Sheffield Database\\
2 & Swaine & Emily & 51 & Tropical Plant Traits From Borneo Database\\
3 & Kleyer & Michael & 25 & The LEDA Traitbase\\
4 & Cornwell & Will & 55 & Jasper Ridge Californian Woody Plants Database\\
5 & Lloyd & Jon & 34 & The RAINFOR Plant Trait Database\\
\bottomrule
\end{longtable*}
\endgroup{}

\newpage

\textbf{Table S2}: Characteristics of \DIFaddbegin \DIFadd{the }\DIFaddend sub-datasets used to select
the best predictive model \DIFdelbegin \DIFdel{of }\DIFdelend \DIFaddbegin \DIFadd{for }\DIFaddend each allometric relationship \DIFdelbegin \DIFdel{for }\DIFdelend \DIFaddbegin \DIFadd{in
}\DIFaddend angiosperms and gymnosperms. The ranges represent the minimum and
maximum values for the respective variables: DBH (cm), tree height (H,
m), crown radius (CR, m), and wood density (WD, g
cm\DIFdelbegin \DIFdel{\(^{-3}\)}\DIFdelend \DIFaddbegin \DIFadd{\textsuperscript{-3}}\DIFaddend ).

\begingroup\fontsize{10}{12}\selectfont

\begin{longtable*}[t]{ccccc}
\toprule
Dependent variables & Predictor variable & Characteristics & Angiosperm & Gymnosperm\\
\midrule
H & DBH & Number of trees & 79,332 & 6,306\\
H & DBH & Number of species & 1,214 & 76\\
H & DBH & Dependent variable range & 1.3 - 94 & 1.3 - 115.8\\
H & DBH & Predictor variable range & 1 - 560 & 1 - 648\\
H & DBH & WD range & 0.131 - 1.17 & 0.32 - 0.689\\
\addlinespace
CR & DBH & Number of trees & 45,350 & 4,632\\
CR & DBH & Number of species & 762 & 59\\
CR & DBH & Dependent variable range & 0.05 - 24.25 & 0.1 - 8.75\\
CR & DBH & Predictor variable range & 1 - 385 & 1 - 266\\
CR & DBH & WD range & 0.131 - 1.15 & 0.32 - 0.689\\
\addlinespace
DBH & CR, H & Number of trees & 41,713 & 3,661\\
DBH & CR, H & Number of species & 744 & 56\\
DBH & CR, H & Dependent variable range & 1 - 385 & 1 - 266\\
DBH & CR, H & Predictor variable range & CR: 0.1 - 24.25 H: 1.3 - 70.6 & CR: 0.1 - 10.65 H: 1.3 - 46.2\\
DBH & CR, H & WD range & 0.131 - 1.15 & 0.32 - 0.651\\
\addlinespace
DBH & CR × H & Number of trees & 41,733 & 3,716\\
DBH & CR × H & Number of species & 743 & 56\\
DBH & CR × H & Dependent variable range & 1 - 385 & 1 - 266\\
DBH & CR × H & Predictor variable range & CR: 0.1 - 24.25 H: 1.3 - 70.6 & CR: 0.15 - 10.65 H: 1.5 - 53.9\\
DBH & CR × H & WD range & 0.131 - 1.15 & 0.32 - 0.651\\
\addlinespace
DBH & CR & Number of trees & 41,733 & 3,702\\
DBH & CR & Number of species & 744 & 56\\
DBH & CR & Dependent variable range & 1 - 385 & 1 - 266\\
DBH & CR & Predictor variable range & 0.1 - 24.25 & 0.15 - 8.75\\
DBH & CR & WD range & 0.131 - 1.15 & 0.32 - 0.651\\
\addlinespace
DBH & H & Number of trees & 41,689 & 3,648\\
DBH & H & Number of species & 746 & 55\\
DBH & H & Dependent variable range & 1 - 385 & 1 - 266\\
DBH & H & Predictor variable range & 1.3 - 70.6 & 1.5 - 46.2\\
DBH & H & WD range & 0.131 - 1.15 & 0.32 - 0.651\\
\bottomrule
\end{longtable*}
\endgroup{}

\newpage

\textbf{Table S3}: Posterior estimates of the parameters of the
hierarchical models for tree height allometry. Table entries correspond
to the median and 95\% CIs for the community-level parameters of each
allometric function.

\begingroup\fontsize{10}{12}\selectfont

\begin{longtable*}[t]{ccccccc}
\toprule
Division & Functional\_form & Wood\_density & Parameter & Intercept\_CI & Slope\_CI & Tau\_CI\\
\midrule
Angiosperm & Power-Law & Without & a & 2.55 (2.50, 2.60) & - & \DIFdelbegin \DIFdel{0.31 (0.30, 0.33}\DIFdelend \DIFaddbegin \DIFadd{0.311 (0.296, 0.326}\DIFaddend )\\
Angiosperm & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.54 (0.53, 0.54}\DIFdelend \DIFaddbegin \DIFadd{0.538 (0.530, 0.544}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.11 (0.10, 0.11}\DIFdelend \DIFaddbegin \DIFadd{0.108 (0.103, 0.114}\DIFaddend )\\
Angiosperm & gMM & Without & a & \DIFdelbegin \DIFdel{77.90 (73.81, 82.50}\DIFdelend \DIFaddbegin \DIFadd{77.9 (73.8, 82.5}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.14 (0.11, 0.16}\DIFdelend \DIFaddbegin \DIFadd{0.140 (0.115, 0.164}\DIFaddend )\\
Angiosperm & gMM & Without & b & \DIFdelbegin \DIFdel{0.64 (0.63, 0.65}\DIFdelend \DIFaddbegin \DIFadd{0.640 (0.629, 0.651}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.15 (0.14, 0.16}\DIFdelend \DIFaddbegin \DIFadd{0.148 (0.140, 0.156}\DIFaddend )\\
Angiosperm & gMM & Without & k & \DIFdelbegin \DIFdel{34.95 (33.24, 36.86}\DIFdelend \DIFaddbegin \DIFadd{35.0 (33.2, 36.9}\DIFaddend ) & - & 8.95 (8.23, 9.66)\\
\addlinespace
Angiosperm & Weibull & Without & a & \DIFdelbegin \DIFdel{49.99 (48.04, 52.17}\DIFdelend \DIFaddbegin \DIFadd{50.0 (48.0, 52.2}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.11 (0.08, 0.13}\DIFdelend \DIFaddbegin \DIFadd{0.109 (0.0847, 0.133}\DIFaddend )\\
Angiosperm & Weibull & Without & b & \DIFdelbegin \DIFdel{0.05 (0.05, 0.05}\DIFdelend \DIFaddbegin \DIFadd{0.0476 (0.0458, 0.0495}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.01 (0.01, 0.01}\DIFdelend \DIFaddbegin \DIFadd{0.0118 (0.0110, 0.0126}\DIFaddend )\\
Angiosperm & Weibull & Without & k & \DIFdelbegin \DIFdel{0.63 (0.62, 0.64}\DIFdelend \DIFaddbegin \DIFadd{0.629 (0.618, 0.639}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.14 (0.14, 0.15}\DIFdelend \DIFaddbegin \DIFadd{0.142 (0.135, 0.149}\DIFaddend )\\
Angiosperm & Weibull & With & a & \DIFdelbegin \DIFdel{50.04 (48.02, 52.28}\DIFdelend \DIFaddbegin \DIFadd{50.0 (48.0, 52.3}\DIFaddend ) & 1.00 (\DIFdelbegin \DIFdel{0.97}\DIFdelend \DIFaddbegin \DIFadd{0.966}\DIFaddend , 1.04) & \DIFdelbegin \DIFdel{0.11 (0.09, 0.13}\DIFdelend \DIFaddbegin \DIFadd{0.109 (0.0850, 0.134}\DIFaddend )\\
Angiosperm & Weibull & With & b & \DIFdelbegin \DIFdel{0.05 (0.05, 0.05}\DIFdelend \DIFaddbegin \DIFadd{0.0477 (0.0456, 0.0495}\DIFaddend ) & \DIFdelbegin \DIFdel{-0.000 (-0.002, 0.001}\DIFdelend \DIFaddbegin \DIFadd{-0.000250 (-0.00189, 0.00142}\DIFaddend ) & \DIFdelbegin \DIFdel{0.01 (0.01, 0.01}\DIFdelend \DIFaddbegin \DIFadd{0.0118 (0.0109, 0.0126}\DIFaddend )\\
\addlinespace
Angiosperm & Weibull & With & k & \DIFdelbegin \DIFdel{0.63 (0.62, 0.64}\DIFdelend \DIFaddbegin \DIFadd{0.628 (0.618, 0.638}\DIFaddend ) & \DIFdelbegin \DIFdel{-0.02 (-0.03, -0.006}\DIFdelend \DIFaddbegin \DIFadd{-0.0155 (-0.0254, -0.00591}\DIFaddend ) & \DIFdelbegin \DIFdel{0.14 (0.13, 0.15}\DIFdelend \DIFaddbegin \DIFadd{0.141 (0.134, 0.149}\DIFaddend )\\
Gymnosperm & Power-Law & Without & a & 1.43 (1.30, 1.56) & - & \DIFdelbegin \DIFdel{0.37 (0.30, 0.45}\DIFdelend \DIFaddbegin \DIFadd{0.371 (0.303, 0.447}\DIFaddend )\\
Gymnosperm & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.70 (0.67, 0.73}\DIFdelend \DIFaddbegin \DIFadd{0.704 (0.675, 0.732}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.11 (0.09, 0.14}\DIFdelend \DIFaddbegin \DIFadd{0.113 (0.0927, 0.137}\DIFaddend )\\
Gymnosperm & gMM & Without & a & \DIFdelbegin \DIFdel{2004.65 (386.15, 7618.20}\DIFdelend \DIFaddbegin \DIFadd{2005 (386, 7618}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.36 (0.30, 0.43}\DIFdelend \DIFaddbegin \DIFadd{0.360 (0.298, 0.434}\DIFaddend )\\
Gymnosperm & gMM & Without & b & \DIFdelbegin \DIFdel{0.72 (0.69, 0.75}\DIFdelend \DIFaddbegin \DIFadd{0.716 (0.687, 0.746}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.11 (0.09, 0.14}\DIFdelend \DIFaddbegin \DIFadd{0.112 (0.0908, 0.138}\DIFaddend )\\
\addlinespace
Gymnosperm & gMM & Without & k & 1427 (\DIFdelbegin \DIFdel{287.33, 5308.34}\DIFdelend \DIFaddbegin \DIFadd{287, 5308}\DIFaddend ) & - & 5.90 (\DIFdelbegin \DIFdel{0.08, 32.24}\DIFdelend \DIFaddbegin \DIFadd{0.0814, 32.2}\DIFaddend )\\
Gymnosperm & Weibull & Without & a & \DIFdelbegin \DIFdel{117.41 (89.22, 175.13}\DIFdelend \DIFaddbegin \DIFadd{117 (89.2, 175}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.09 (0.004, 0.23}\DIFdelend \DIFaddbegin \DIFadd{0.0912 (0.00357, 0.229}\DIFaddend )\\
Gymnosperm & Weibull & Without & b & \DIFdelbegin \DIFdel{0.01 (0.008, 0.02}\DIFdelend \DIFaddbegin \DIFadd{0.0119 (0.00806, 0.0155}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.004 (0.002, 0.005}\DIFdelend \DIFaddbegin \DIFadd{0.00371 (0.00230, 0.00525}\DIFaddend )\\
Gymnosperm & Weibull & Without & k & \DIFdelbegin \DIFdel{0.75 (0.72, 0.78}\DIFdelend \DIFaddbegin \DIFadd{0.750 (0.719, 0.784}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.11 (0.09, 0.14}\DIFdelend \DIFaddbegin \DIFadd{0.114 (0.0919, 0.139}\DIFaddend )\\
Gymnosperm & Weibull & With & a & \DIFdelbegin \DIFdel{114.39 (85.14, 170.40}\DIFdelend \DIFaddbegin \DIFadd{114 (85.1, 170}\DIFaddend ) & \DIFdelbegin \DIFdel{0.97 (0.78}\DIFdelend \DIFaddbegin \DIFadd{0.974 (0.776}\DIFaddend , 1.21) & \DIFdelbegin \DIFdel{0.10 (0.005, 0.26}\DIFdelend \DIFaddbegin \DIFadd{0.0976 (0.00466, 0.257}\DIFaddend )\\
\addlinespace
Gymnosperm & Weibull & With & b & \DIFdelbegin \DIFdel{0.01 (0.008, 0.02}\DIFdelend \DIFaddbegin \DIFadd{0.0123 (0.00836, 0.0163}\DIFaddend ) & \DIFdelbegin \DIFdel{0.001 (-0.002, 0.003}\DIFdelend \DIFaddbegin \DIFadd{0.000633 (-0.00188, 0.00342}\DIFaddend ) & \DIFdelbegin \DIFdel{0.004 (0.002, 0.006}\DIFdelend \DIFaddbegin \DIFadd{0.00382 (0.00225, 0.00553}\DIFaddend )\\
Gymnosperm & Weibull & With & k & \DIFdelbegin \DIFdel{0.75 (0.72, 0.78}\DIFdelend \DIFaddbegin \DIFadd{0.751 (0.721, 0.784}\DIFaddend ) & \DIFdelbegin \DIFdel{-0.02 (-0.05, 0.008}\DIFdelend \DIFaddbegin \DIFadd{-0.0224 (-0.0538, 0.00762}\DIFaddend ) & \DIFdelbegin \DIFdel{0.11 (0.09, 0.14}\DIFdelend \DIFaddbegin \DIFadd{0.113 (0.0905, 0.140}\DIFaddend )\\
\bottomrule
\end{longtable*}
\endgroup{}

\newpage

\textbf{Table S4}: Posterior estimates of the parameters of the
hierarchical models for crown radius allometry. Table entries correspond
to the median and 95\% CIs for the community-level parameters of each
allometric function.

\begingroup\fontsize{10}{12}\selectfont

\begin{longtable*}[t]{ccccccc}
\toprule
Division & Functional\_form & Wood\_density & Parameter & Intercept\_CI & Slope\_CI & Tau\_CI\\
\midrule
Angiosperm & Power-Law & Without & a & \DIFdelbegin \DIFdel{0.35 (0.34, 0.36}\DIFdelend \DIFaddbegin \DIFadd{0.349 (0.340, 0.359}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.34 (0.32, 0.36}\DIFdelend \DIFaddbegin \DIFadd{0.336 (0.316, 0.358}\DIFaddend )\\
Angiosperm & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.63 (0.62, 0.63}\DIFdelend \DIFaddbegin \DIFadd{0.626 (0.617, 0.635}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.09 (0.09, 0.10}\DIFdelend \DIFaddbegin \DIFadd{0.0929 (0.0852, 0.101}\DIFaddend )\\
Angiosperm & Power-Law & With & a & \DIFdelbegin \DIFdel{0.35 (0.34, 0.36}\DIFdelend \DIFaddbegin \DIFadd{0.349 (0.340, 0.359}\DIFaddend ) & \DIFdelbegin \DIFdel{0.07 (0.04, 0.10}\DIFdelend \DIFaddbegin \DIFadd{0.0680 (0.0395, 0.0970}\DIFaddend ) & \DIFdelbegin \DIFdel{0.33 (0.31, 0.35}\DIFdelend \DIFaddbegin \DIFadd{0.331 (0.311, 0.354}\DIFaddend )\\
Angiosperm & Power-Law & With & b & \DIFdelbegin \DIFdel{0.63 (0.62, 0.63}\DIFdelend \DIFaddbegin \DIFadd{0.626 (0.617, 0.635}\DIFaddend ) & \DIFdelbegin \DIFdel{-0.01 (-0.02, -0.003}\DIFdelend \DIFaddbegin \DIFadd{-0.0110 (-0.0199, -0.00253}\DIFaddend ) & \DIFdelbegin \DIFdel{0.09 (0.08, 0.10}\DIFdelend \DIFaddbegin \DIFadd{0.0921 (0.0844, 0.100}\DIFaddend )\\
Angiosperm & gMM & Without & a & \DIFdelbegin \DIFdel{1382.37 (625.38, 2564.02}\DIFdelend \DIFaddbegin \DIFadd{1382 (625, 2564}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.34 (0.32, 0.36}\DIFdelend \DIFaddbegin \DIFadd{0.336 (0.315, 0.357}\DIFaddend )\\
\addlinespace
Angiosperm & gMM & Without & b & \DIFdelbegin \DIFdel{0.63 (0.62, 0.64}\DIFdelend \DIFaddbegin \DIFadd{0.627 (0.618, 0.636}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.09 (0.09, 0.10}\DIFdelend \DIFaddbegin \DIFadd{0.0932 (0.0858, 0.101}\DIFaddend )\\
Angiosperm & gMM & Without & k & \DIFdelbegin \DIFdel{3974.91 (1807.16, 7385.72}\DIFdelend \DIFaddbegin \DIFadd{3975 (1807, 7386}\DIFaddend ) & - & 7.24 (\DIFdelbegin \DIFdel{0.09, 50.73}\DIFdelend \DIFaddbegin \DIFadd{0.0919, 50.7}\DIFaddend )\\
Angiosperm & Weibull & Without & a & \DIFdelbegin \DIFdel{458.39 (174.88, 1761.34}\DIFdelend \DIFaddbegin \DIFadd{458 (175, 1761}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.31 (0.25, 0.35}\DIFdelend \DIFaddbegin \DIFadd{0.311 (0.255, 0.348}\DIFaddend )\\
Angiosperm & Weibull & Without & b & \DIFdelbegin \DIFdel{0.001 (0.000, 0.002}\DIFdelend \DIFaddbegin \DIFadd{0.000765 (0.000200, 0.00200}\DIFaddend ) & - & \DIFdelbegin \DIFdel{9.67}\DIFdelend \DIFaddbegin \DIFadd{9.6665278454}\DIFaddend e-05 (\DIFdelbegin \DIFdel{5.09}\DIFdelend \DIFaddbegin \DIFadd{5.092834}\DIFaddend e-06, \DIFdelbegin \DIFdel{0.000}\DIFdelend \DIFaddbegin \DIFadd{0.00031932395}\DIFaddend )\\
Angiosperm & Weibull & Without & k & \DIFdelbegin \DIFdel{0.63 (0.62, 0.64}\DIFdelend \DIFaddbegin \DIFadd{0.627 (0.619, 0.637}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.09 (0.09, 0.10}\DIFdelend \DIFaddbegin \DIFadd{0.0934 (0.0859, 0.101}\DIFaddend )\\
\addlinespace
Gymnosperm & Power-Law & Without & a & \DIFdelbegin \DIFdel{0.30 (0.27, 0.33}\DIFdelend \DIFaddbegin \DIFadd{0.298 (0.270, 0.329}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.32 (0.25, 0.41}\DIFdelend \DIFaddbegin \DIFadd{0.324 (0.251, 0.415}\DIFaddend )\\
Gymnosperm & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.62 (0.59, 0.65}\DIFdelend \DIFaddbegin \DIFadd{0.619 (0.591, 0.647}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.09 (0.06, 0.11}\DIFdelend \DIFaddbegin \DIFadd{0.0861 (0.0627, 0.114}\DIFaddend )\\
Gymnosperm & gMM & Without & a & \DIFdelbegin \DIFdel{769.41 (227.35, 1818.31}\DIFdelend \DIFaddbegin \DIFadd{769 (227, 1818}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.37 (0.28, 0.47}\DIFdelend \DIFaddbegin \DIFadd{0.367 (0.280, 0.465}\DIFaddend )\\
Gymnosperm & gMM & Without & b & \DIFdelbegin \DIFdel{0.63 (0.60, 0.66}\DIFdelend \DIFaddbegin \DIFadd{0.631 (0.600, 0.663}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.10 (0.08, 0.13}\DIFdelend \DIFaddbegin \DIFadd{0.101 (0.0755, 0.131}\DIFaddend )\\
Gymnosperm & gMM & Without & k & \DIFdelbegin \DIFdel{2657.08 (808.71, 6274.34}\DIFdelend \DIFaddbegin \DIFadd{2657 (809, 6274}\DIFaddend ) & - & \DIFdelbegin \DIFdel{18.98 (0.11, 200.19}\DIFdelend \DIFaddbegin \DIFadd{19.0 (0.112, 200}\DIFaddend )\\
\addlinespace
Gymnosperm & gMM & With & a & \DIFdelbegin \DIFdel{975.00 (311.90, 2010.23}\DIFdelend \DIFaddbegin \DIFadd{975 (312, 2010}\DIFaddend ) & \DIFdelbegin \DIFdel{0.99 (0.77}\DIFdelend \DIFaddbegin \DIFadd{0.988 (0.766}\DIFaddend , 1.27) & \DIFdelbegin \DIFdel{0.37 (0.28, 0.47}\DIFdelend \DIFaddbegin \DIFadd{0.367 (0.280, 0.474}\DIFaddend )\\
Gymnosperm & gMM & With & b & \DIFdelbegin \DIFdel{0.63 (0.60, 0.66}\DIFdelend \DIFaddbegin \DIFadd{0.629 (0.599, 0.659}\DIFaddend ) & \DIFdelbegin \DIFdel{0.03 (0.005, 0.06}\DIFdelend \DIFaddbegin \DIFadd{0.0345 (0.00507, 0.0642}\DIFaddend ) & \DIFdelbegin \DIFdel{0.09 (0.07, 0.13}\DIFdelend \DIFaddbegin \DIFadd{0.0949 (0.0691, 0.126}\DIFaddend )\\
Gymnosperm & gMM & With & k & \DIFdelbegin \DIFdel{3371.46 (1094.23, 6977.77}\DIFdelend \DIFaddbegin \DIFadd{3371 (1094, 6978}\DIFaddend ) & \DIFdelbegin \DIFdel{35.71 (-768.70, 913.80}\DIFdelend \DIFaddbegin \DIFadd{35.7 (-769, 914}\DIFaddend ) & 9.36 (\DIFdelbegin \DIFdel{0.10, 52.32}\DIFdelend \DIFaddbegin \DIFadd{0.100, 52.3}\DIFaddend )\\
Gymnosperm & Weibull & Without & a & \DIFdelbegin \DIFdel{61.02 (21.51, 321.80}\DIFdelend \DIFaddbegin \DIFadd{61.0 (21.5, 322}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.20 (0.01, 0.41}\DIFdelend \DIFaddbegin \DIFadd{0.202 (0.0145, 0.411}\DIFaddend )\\
Gymnosperm & Weibull & Without & b & \DIFdelbegin \DIFdel{0.005 (0.001, 0.01}\DIFdelend \DIFaddbegin \DIFadd{0.00487 (0.000906, 0.0139}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.002 (5.17}\DIFdelend \DIFaddbegin \DIFadd{0.00156209428218 (5.166957}\DIFaddend e-05, \DIFdelbegin \DIFdel{0.005}\DIFdelend \DIFaddbegin \DIFadd{0.00459459775}\DIFaddend )\\
\addlinespace
Gymnosperm & Weibull & Without & k & \DIFdelbegin \DIFdel{0.64 (0.61, 0.67}\DIFdelend \DIFaddbegin \DIFadd{0.640 (0.606, 0.674}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.10 (0.08, 0.13}\DIFdelend \DIFaddbegin \DIFadd{0.102 (0.0775, 0.133}\DIFaddend )\\
\bottomrule
\end{longtable*}
\endgroup{}

\newpage

\textbf{Table S5}: Posterior estimates of the parameters of the
hierarchical models for DBH allometry. Table entries correspond to the
median and 95\% CIs for the community-level parameters of each
allometric function.

\begingroup\fontsize{10}{12}\selectfont

\begin{longtable*}[t]{cccccccc}
\toprule
Division & Predictor & Functional\_form & Wood\_density & Parameter & Intercept\_CI & Slope\_CI & Tau\_CI\\
\midrule
Angiosperm & CR, H & Power-Law & Without & a & \DIFdelbegin \DIFdel{0.95 (0.93, 0.97}\DIFdelend \DIFaddbegin \DIFadd{0.948 (0.927, 0.969}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.30 (0.28, 0.32}\DIFdelend \DIFaddbegin \DIFadd{0.302 (0.284, 0.320}\DIFaddend )\\
Angiosperm & CR, H & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.37 (0.36, 0.39}\DIFdelend \DIFaddbegin \DIFadd{0.374 (0.361, 0.386}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.13 (0.13, 0.15}\DIFdelend \DIFaddbegin \DIFadd{0.135 (0.125, 0.145}\DIFaddend )\\
Angiosperm & CR, H & Power-Law & Without & c & \DIFdelbegin \DIFdel{0.59 (0.57, 0.60}\DIFdelend \DIFaddbegin \DIFadd{0.590 (0.575, 0.605}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.17 (0.16, 0.18}\DIFdelend \DIFaddbegin \DIFadd{0.168 (0.157, 0.180}\DIFaddend )\\
Angiosperm & CR, H & Power-Law & With & a & \DIFdelbegin \DIFdel{0.95 (0.93, 0.97}\DIFdelend \DIFaddbegin \DIFadd{0.949 (0.928, 0.970}\DIFaddend ) & \DIFdelbegin \DIFdel{-0.003 (-0.03, 0.02}\DIFdelend \DIFaddbegin \DIFadd{-0.00254 (-0.0265, 0.0190}\DIFaddend ) & \DIFdelbegin \DIFdel{0.30 (0.28, 0.32}\DIFdelend \DIFaddbegin \DIFadd{0.301 (0.284, 0.320}\DIFaddend )\\
Angiosperm & CR, H & Power-Law & With & b & \DIFdelbegin \DIFdel{0.37 (0.36, 0.39}\DIFdelend \DIFaddbegin \DIFadd{0.373 (0.361, 0.386}\DIFaddend ) & \DIFdelbegin \DIFdel{-0.003 (-0.01, 0.009}\DIFdelend \DIFaddbegin \DIFadd{-0.00327 (-0.0146, 0.00891}\DIFaddend ) & \DIFdelbegin \DIFdel{0.14 (0.13, 0.15}\DIFdelend \DIFaddbegin \DIFadd{0.135 (0.125, 0.145}\DIFaddend )\\
\addlinespace
Angiosperm & CR, H & Power-Law & With & c & \DIFdelbegin \DIFdel{0.59 (0.57, 0.60}\DIFdelend \DIFaddbegin \DIFadd{0.589 (0.575, 0.605}\DIFaddend ) & \DIFdelbegin \DIFdel{0.005 (-0.010, 0.02}\DIFdelend \DIFaddbegin \DIFadd{0.00511 (-0.00957, 0.0200}\DIFaddend ) & \DIFdelbegin \DIFdel{0.17 (0.16, 0.18}\DIFdelend \DIFaddbegin \DIFadd{0.168 (0.156, 0.179}\DIFaddend )\\
Angiosperm & CR × H & Power-Law & Without & a & \DIFdelbegin \DIFdel{0.96 (0.93, 0.98}\DIFdelend \DIFaddbegin \DIFadd{0.955 (0.934, 0.978}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.31 (0.29, 0.32}\DIFdelend \DIFaddbegin \DIFadd{0.307 (0.291, 0.325}\DIFaddend )\\
Angiosperm & CR × H & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.87 (0.86, 0.89}\DIFdelend \DIFaddbegin \DIFadd{0.873 (0.859, 0.886}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.17 (0.16, 0.18}\DIFdelend \DIFaddbegin \DIFadd{0.167 (0.156, 0.178}\DIFaddend )\\
Angiosperm & CR & Power-Law & Without & a & \DIFdelbegin \DIFdel{0.95 (0.92, 0.98}\DIFdelend \DIFaddbegin \DIFadd{0.950 (0.917, 0.983}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.42 (0.40, 0.45}\DIFdelend \DIFaddbegin \DIFadd{0.424 (0.403, 0.447}\DIFaddend )\\
Angiosperm & CR & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.72 (0.70, 0.74}\DIFdelend \DIFaddbegin \DIFadd{0.717 (0.699, 0.735}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.24 (0.22, 0.25}\DIFdelend \DIFaddbegin \DIFadd{0.236 (0.223, 0.251}\DIFaddend )\\
\addlinespace
Angiosperm & H & Power-Law & Without & a & \DIFdelbegin \DIFdel{0.97 (0.94, 0.99}\DIFdelend \DIFaddbegin \DIFadd{0.967 (0.941, 0.993}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.35 (0.33, 0.37}\DIFdelend \DIFaddbegin \DIFadd{0.353 (0.334, 0.373}\DIFaddend )\\
Angiosperm & H & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.87 (0.85, 0.88}\DIFdelend \DIFaddbegin \DIFadd{0.866 (0.849, 0.881}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.20 (0.19, 0.21}\DIFdelend \DIFaddbegin \DIFadd{0.200 (0.188, 0.214}\DIFaddend )\\
Gymnosperm & CR, H & Power-Law & Without & a & \DIFdelbegin \DIFdel{0.97 (0.90}\DIFdelend \DIFaddbegin \DIFadd{0.972 (0.903}\DIFaddend , 1.05) & - & \DIFdelbegin \DIFdel{0.27 (0.22, 0.34}\DIFdelend \DIFaddbegin \DIFadd{0.273 (0.222, 0.336}\DIFaddend )\\
Gymnosperm & CR, H & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.41 (0.37, 0.45}\DIFdelend \DIFaddbegin \DIFadd{0.410 (0.373, 0.446}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.11 (0.09, 0.15}\DIFdelend \DIFaddbegin \DIFadd{0.115 (0.0861, 0.150}\DIFaddend )\\
Gymnosperm & CR, H & Power-Law & Without & c & \DIFdelbegin \DIFdel{0.59 (0.54, 0.64}\DIFdelend \DIFaddbegin \DIFadd{0.588 (0.540, 0.638}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.17 (0.13, 0.21}\DIFdelend \DIFaddbegin \DIFadd{0.165 (0.129, 0.209}\DIFaddend )\\
\addlinespace
Gymnosperm & CR, H & Power-Law & With & a & \DIFdelbegin \DIFdel{0.97 (0.90}\DIFdelend \DIFaddbegin \DIFadd{0.971 (0.900}\DIFaddend , 1.04) & \DIFdelbegin \DIFdel{-0.05 (-0.12, 0.03}\DIFdelend \DIFaddbegin \DIFadd{-0.0451 (-0.120, 0.0295}\DIFaddend ) & \DIFdelbegin \DIFdel{0.27 (0.22, 0.34}\DIFdelend \DIFaddbegin \DIFadd{0.274 (0.225, 0.339}\DIFaddend )\\
Gymnosperm & CR, H & Power-Law & With & b & \DIFdelbegin \DIFdel{0.41 (0.37, 0.44}\DIFdelend \DIFaddbegin \DIFadd{0.408 (0.371, 0.444}\DIFaddend ) & \DIFdelbegin \DIFdel{0.03 (-0.008, 0.06}\DIFdelend \DIFaddbegin \DIFadd{0.0284 (-0.00773, 0.0616}\DIFaddend ) & \DIFdelbegin \DIFdel{0.11 (0.08, 0.15}\DIFdelend \DIFaddbegin \DIFadd{0.112 (0.0845, 0.148}\DIFaddend )\\
Gymnosperm & CR, H & Power-Law & With & c & \DIFdelbegin \DIFdel{0.59 (0.54, 0.64}\DIFdelend \DIFaddbegin \DIFadd{0.588 (0.538, 0.637}\DIFaddend ) & \DIFdelbegin \DIFdel{-0.04 (-0.08, 0.01}\DIFdelend \DIFaddbegin \DIFadd{-0.0364 (-0.0841, 0.0140}\DIFaddend ) & \DIFdelbegin \DIFdel{0.16 (0.13, 0.21}\DIFdelend \DIFaddbegin \DIFadd{0.165 (0.128, 0.209}\DIFaddend )\\
Gymnosperm & CR × H & Power-Law & Without & a & \DIFdelbegin \DIFdel{0.99 (0.92}\DIFdelend \DIFaddbegin \DIFadd{0.990 (0.920}\DIFaddend , 1.07) & - & \DIFdelbegin \DIFdel{0.28 (0.23, 0.35}\DIFdelend \DIFaddbegin \DIFadd{0.282 (0.231, 0.347}\DIFaddend )\\
Gymnosperm & CR × H & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.89 (0.84, 0.94}\DIFdelend \DIFaddbegin \DIFadd{0.895 (0.843, 0.942}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.18 (0.15, 0.23}\DIFdelend \DIFaddbegin \DIFadd{0.182 (0.147, 0.225}\DIFaddend )\\
\addlinespace
Gymnosperm & CR & Power-Law & Without & a & \DIFdelbegin \DIFdel{0.97 (0.89}\DIFdelend \DIFaddbegin \DIFadd{0.971 (0.887}\DIFaddend , 1.06) & - & \DIFdelbegin \DIFdel{0.34 (0.28, 0.42}\DIFdelend \DIFaddbegin \DIFadd{0.344 (0.280, 0.419}\DIFaddend )\\
Gymnosperm & CR & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.79 (0.71, 0.87}\DIFdelend \DIFaddbegin \DIFadd{0.791 (0.712, 0.870}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.27 (0.22, 0.34}\DIFdelend \DIFaddbegin \DIFadd{0.274 (0.221, 0.336}\DIFaddend )\\
Gymnosperm & H & Power-Law & Without & a & \DIFdelbegin \DIFdel{1.00 (0.90}\DIFdelend \DIFaddbegin \DIFadd{0.998 (0.901}\DIFaddend , 1.09) & - & \DIFdelbegin \DIFdel{0.35 (0.29, 0.43}\DIFdelend \DIFaddbegin \DIFadd{0.348 (0.287, 0.427}\DIFaddend )\\
Gymnosperm & H & Power-Law & Without & b & \DIFdelbegin \DIFdel{0.85 (0.79, 0.92}\DIFdelend \DIFaddbegin \DIFadd{0.849 (0.787, 0.915}\DIFaddend ) & - & \DIFdelbegin \DIFdel{0.22 (0.18, 0.28}\DIFdelend \DIFaddbegin \DIFadd{0.224 (0.179, 0.279}\DIFaddend )\\
\bottomrule
\end{longtable*}
\endgroup{}

\newpage

\begin{figure}[H]

\centering{

\pandocbounded{\includegraphics[keepaspectratio]{../figs/h_cr_dbh_log.png}}

}

\caption{\label{fig-compare}Allometric relationships between tree height
and crown radius \DIFdelbeginFL \DIFdelFL{with }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{versus }\DIFaddendFL DBH \DIFdelbeginFL \DIFdelFL{of angiosperm }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{for angiosperms }\DIFaddendFL (a, c) and \DIFdelbeginFL \DIFdelFL{gymnosperm }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{gymnosperms }\DIFaddendFL (b,
d) based on three different models: power-law (orange), generalized
Michaelis-Menten (green), and Weibull (blue). The density of overlapping
points is \DIFdelbeginFL \DIFdelFL{shown }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{represented }\DIFaddendFL using a colour gradient ranging from black (low
density) to yellow (high density). Point density was calculated using a
2D kernel density estimation on a 300 \(\times\) 300 grid, \DIFdelbeginFL \DIFdelFL{estimating }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{which
estimate }\DIFaddendFL the concentration of data points in the log-transformed \DIFdelbeginFL \DIFdelFL{space of }\DIFdelendFL DBH and
tree height or crown radius. All axes are \DIFaddbeginFL \DIFaddFL{shown }\DIFaddendFL on the log scale.}

\end{figure}%

\newpage

\section{Section S2. Stan code used to fit alternative allometric
models}\label{section-s2.-stan-code-used-to-fit-alternative-allometric-models-1}

\subsection{Power-law model}\label{power-law-model}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each trees}
  \DataTypeTok{matrix}\NormalTok{[N, K] log\_x;                }\CommentTok{// tree{-}level predictors}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[K] gamma;}
  \DataTypeTok{matrix}\NormalTok{[K, J] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[K, J] beta;}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[k, ] = gamma[k] + tau[k] * z[k, ];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  sigma \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{);}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  tau \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  gamma \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_mu[n] = log\_x[n, ] * beta[, jj[n]];}
\NormalTok{  \}}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] | log\_x[n, ] * beta[, jj[n]], sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\newpage

\subsection{Power-law model with wood
density}\label{power-law-model-with-wood-density}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} L;                    }\CommentTok{// num sp{-}level predictor}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each trees}
  \DataTypeTok{matrix}\NormalTok{[N, K] log\_x;                }\CommentTok{// tree{-}level predictors}
  \DataTypeTok{matrix}\NormalTok{[L, J] u;                    }\CommentTok{// sp{-}level predictors}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[K, L] gamma;}
  \DataTypeTok{matrix}\NormalTok{[K, J] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[K, J] beta;}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[k, ] = gamma[k, ] * u + tau[k] * z[k, ];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  to\_vector(gamma) \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  tau \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_mu[n] = log\_x[n, ] * beta[, jj[n]];}
\NormalTok{  \}}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] | log\_x[n, ] * beta[, jj[n]], sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\newpage

\subsection{Generalized Michaelis-Menten
model}\label{generalized-michaelis-menten-model}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each tree}
  \DataTypeTok{vector}\NormalTok{[N] x;                       }\CommentTok{// DBH (non{-}log{-}scale)}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] gamma\_hat;}
  \DataTypeTok{matrix}\NormalTok{[J, K] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[J, K] beta;}
  \DataTypeTok{vector}\NormalTok{[K] gamma;}
\NormalTok{  gamma[}\DecValTok{1}\NormalTok{] = gamma\_hat[}\DecValTok{1}\NormalTok{] * }\DecValTok{10}\NormalTok{;}
\NormalTok{  gamma[}\DecValTok{2}\NormalTok{] = gamma\_hat[}\DecValTok{2}\NormalTok{];}
\NormalTok{  gamma[}\DecValTok{3}\NormalTok{] = gamma\_hat[}\DecValTok{3}\NormalTok{] * }\DecValTok{1000}\NormalTok{;}
  \CommentTok{// Corrected matrix multiplication and addition}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[, k] =  gamma[k] + tau[k] * z[, k];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  sigma \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{);}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  tau \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  gamma\_hat \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  log\_mu = beta[jj, }\DecValTok{1}\NormalTok{] + beta[jj, }\DecValTok{2}\NormalTok{] .* log(x) {-}}
\NormalTok{      log(beta[jj, }\DecValTok{3}\NormalTok{] + pow(x, beta[jj, }\DecValTok{2}\NormalTok{]));}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] |}
\NormalTok{      beta[jj[n], }\DecValTok{1}\NormalTok{] +}
\NormalTok{      beta[jj[n], }\DecValTok{2}\NormalTok{] * log(x[n]) {-}}
\NormalTok{      log(beta[jj[n], }\DecValTok{3}\NormalTok{] + pow(x[n], beta[jj[n], }\DecValTok{2}\NormalTok{])),}
\NormalTok{      sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\newpage

\subsection{Generalized Michaelis-Menten model with wood
density}\label{generalized-michaelis-menten-model-with-wood-density}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} L;                    }\CommentTok{// num sp{-}level predictor}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each tree}
  \DataTypeTok{vector}\NormalTok{[N] x;                       }\CommentTok{// DBH (non{-}log{-}scale)}
  \DataTypeTok{matrix}\NormalTok{[J, L] u;                    }\CommentTok{// sp{-}level predictors}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] gamma\_int\_hat;}
  \DataTypeTok{vector}\NormalTok{[K] gamma\_slope\_hat;}
  \DataTypeTok{matrix}\NormalTok{[J, K] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[J, K] beta;}
  \DataTypeTok{row\_vector}\NormalTok{[K] gamma\_int;}
  \DataTypeTok{row\_vector}\NormalTok{[K] gamma\_slope;}
\NormalTok{  gamma\_int[}\DecValTok{1}\NormalTok{] = gamma\_int\_hat[}\DecValTok{1}\NormalTok{] * }\DecValTok{10}\NormalTok{;}
\NormalTok{  gamma\_int[}\DecValTok{2}\NormalTok{] = gamma\_int\_hat[}\DecValTok{2}\NormalTok{];}
\NormalTok{  gamma\_int[}\DecValTok{3}\NormalTok{] = gamma\_int\_hat[}\DecValTok{3}\NormalTok{] * }\DecValTok{1000}\NormalTok{;}
\NormalTok{  gamma\_slope[}\DecValTok{1}\NormalTok{] = gamma\_slope\_hat[}\DecValTok{1}\NormalTok{] * }\DecValTok{10}\NormalTok{;}
\NormalTok{  gamma\_slope[}\DecValTok{2}\NormalTok{] = gamma\_slope\_hat[}\DecValTok{2}\NormalTok{];}
\NormalTok{  gamma\_slope[}\DecValTok{3}\NormalTok{] = gamma\_slope\_hat[}\DecValTok{3}\NormalTok{] * }\DecValTok{1000}\NormalTok{;}
  \DataTypeTok{matrix}\NormalTok{[}\DecValTok{2}\NormalTok{, K] gamma = append\_row(gamma\_int, gamma\_slope);}

  \CommentTok{// Corrected matrix multiplication and addition}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[, k] = u * gamma[, k] + tau[k] * z[, k];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  tau \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  gamma\_int\_hat \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  gamma\_slope\_hat \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{1.25}\NormalTok{);}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_mu[n] = beta[jj[n], }\DecValTok{1}\NormalTok{] + beta[jj[n], }\DecValTok{2}\NormalTok{] * log(x[n]) {-}}
\NormalTok{      log(beta[jj[n], }\DecValTok{3}\NormalTok{] + pow(x[n], beta[jj[n], }\DecValTok{2}\NormalTok{]));}
\NormalTok{  \}}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] |}
\NormalTok{      beta[jj[n], }\DecValTok{1}\NormalTok{] +}
\NormalTok{      beta[jj[n], }\DecValTok{2}\NormalTok{] * log(x[n]) {-}}
\NormalTok{      log(beta[jj[n], }\DecValTok{3}\NormalTok{] + pow(x[n], beta[jj[n], }\DecValTok{2}\NormalTok{])),}
\NormalTok{      sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\newpage

\subsection{Weibull model}\label{weibull-model}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each tree}
  \DataTypeTok{vector}\NormalTok{[N] x;                       }\CommentTok{// DBH (non{-}log{-}scale)}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] gamma;}
  \DataTypeTok{matrix}\NormalTok{[J, K] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[J, K] beta;}
  \CommentTok{// Corrected matrix multiplication and addition}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[, k] =  gamma[k] + tau[k] * z[, k];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  sigma \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{);}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  tau \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  gamma \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  log\_mu = beta[jj, }\DecValTok{1}\NormalTok{] + log1m\_exp({-}beta[jj, }\DecValTok{2}\NormalTok{] .* pow(x, beta[jj, }\DecValTok{3}\NormalTok{]));}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] |}
\NormalTok{      beta[jj[n], }\DecValTok{1}\NormalTok{] + log1m\_exp({-}beta[jj[n], }\DecValTok{2}\NormalTok{] * pow(x[n], beta[jj[n], }\DecValTok{3}\NormalTok{])),}
\NormalTok{      sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\newpage

\subsection{Weibull model with wood
density}\label{weibull-model-with-wood-density}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ \{}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} N;                    }\CommentTok{// num trees}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} J;                    }\CommentTok{// num sp}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} K;                    }\CommentTok{// num of tree{-}level predictors}
  \DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{\textgreater{} L;                    }\CommentTok{// num sp{-}level predictor}
  \DataTypeTok{array}\NormalTok{[N] }\DataTypeTok{int}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{1}\NormalTok{, }\KeywordTok{upper}\NormalTok{=J\textgreater{} jj; }\CommentTok{// sp indicator for each tree}
  \DataTypeTok{vector}\NormalTok{[N] x;                       }\CommentTok{// DBH (non{-}log{-}scale)}
  \DataTypeTok{matrix}\NormalTok{[J, L] u;                    }\CommentTok{// sp{-}level predictors}
  \DataTypeTok{vector}\NormalTok{[N] log\_y;                   }\CommentTok{// outcomes}
\NormalTok{\}}

\KeywordTok{parameters}\NormalTok{ \{}
  \DataTypeTok{row\_vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] gamma\_int;}
  \DataTypeTok{row\_vector}\NormalTok{[K] gamma\_slope;}
  \DataTypeTok{matrix}\NormalTok{[J, K] z;}
  \DataTypeTok{vector}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{}[K] tau;}
  \DataTypeTok{real}\NormalTok{\textless{}}\KeywordTok{lower}\NormalTok{=}\DecValTok{0}\NormalTok{\textgreater{} sigma;}
\NormalTok{\}}

\KeywordTok{transformed parameters}\NormalTok{ \{}
  \DataTypeTok{matrix}\NormalTok{[J, K] beta;}
  \DataTypeTok{matrix}\NormalTok{[}\DecValTok{2}\NormalTok{, K] gamma = append\_row(gamma\_int, gamma\_slope);}

  \CommentTok{// Corrected matrix multiplication and addition}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:K) \{}
\NormalTok{    beta[, k] = u * gamma[, k] + tau[k] * z[, k];}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{model}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_mu;}
\NormalTok{  to\_vector(z) \textasciitilde{} std\_normal();}
\NormalTok{  to\_vector(gamma\_int) \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
\NormalTok{  to\_vector(gamma\_slope) \textasciitilde{} normal(}\DecValTok{0}\NormalTok{, }\FloatTok{1.25}\NormalTok{);}
\NormalTok{  to\_vector(tau) \textasciitilde{} cauchy(}\DecValTok{0}\NormalTok{, }\FloatTok{2.5}\NormalTok{);}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_mu[n] = beta[jj[n], }\DecValTok{1}\NormalTok{] + log1m\_exp({-}beta[jj[n], }\DecValTok{2}\NormalTok{] * pow(x[n], beta[jj[n], }\DecValTok{3}\NormalTok{]));}
\NormalTok{  \}}
\NormalTok{  log\_y \textasciitilde{} normal(log\_mu, sigma);}
\NormalTok{\}}

\KeywordTok{generated quantities}\NormalTok{ \{}
  \DataTypeTok{vector}\NormalTok{[N] log\_lik;}
  \ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in} \DecValTok{1}\NormalTok{:N) \{}
\NormalTok{    log\_lik[n] = normal\_lpdf(log\_y[n] |}
\NormalTok{      beta[jj[n], }\DecValTok{1}\NormalTok{] + log1m\_exp({-}beta[jj[n], }\DecValTok{2}\NormalTok{] * pow(x[n], beta[jj[n], }\DecValTok{3}\NormalTok{])),}
\NormalTok{      sigma);}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}





\end{document}
